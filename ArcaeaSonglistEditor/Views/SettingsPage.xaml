<Page x:Class="ArcaeaSonglistEditor.Views.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:vm="clr-namespace:ArcaeaSonglistEditor.ViewModels"
      Title="设置"
      Width="Auto"
      Height="Auto">
    

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <TextBlock Grid.Row="0"
                   Text="设置"
                   Style="{StaticResource PageTitleText}" />

        <!-- 设置内容 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Orientation="Vertical">
                <!-- 常规设置 -->
                <GroupBox Header="常规设置">
                    <StackPanel Orientation="Vertical">
                        <CheckBox Content="启动时自动加载上次的文件"
                                  IsChecked="{Binding AutoLoadLastFile}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="保存时自动备份"
                                  IsChecked="{Binding AutoBackupOnSave}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="显示确认对话框"
                                  IsChecked="{Binding ShowConfirmationDialogs}"
                                  Margin="0,0,0,10" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="默认语言:"
                                       Style="{StaticResource FieldLabelText}" />
                            <ComboBox Grid.Column="1"
                                      MinWidth="160"
                                      SelectedItem="{Binding DefaultLanguage}">
                                <ComboBoxItem Content="English" />
                                <ComboBoxItem Content="日本語" />
                                <ComboBoxItem Content="한국어" />
                                <ComboBoxItem Content="简体中文" />
                                <ComboBoxItem Content="繁體中文" />
                            </ComboBox>
                        </Grid>
                    </StackPanel>
                </GroupBox>

                <!-- 编辑器设置 -->
                <GroupBox Header="编辑器设置">
                    <StackPanel Orientation="Vertical">
                        <CheckBox Content="自动验证输入数据"
                                  IsChecked="{Binding AutoValidateInput}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="显示高级选项"
                                  IsChecked="{Binding ShowAdvancedOptions}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="启用实时预览"
                                  IsChecked="{Binding EnableLivePreview}"
                                  Margin="0,0,0,10" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="默认日期格式:"
                                       Style="{StaticResource FieldLabelText}" />
                            <ComboBox Grid.Column="1"
                                      MinWidth="180"
                                      SelectedItem="{Binding DefaultDateFormat}">
                                <ComboBoxItem Content="Unix时间戳" />
                                <ComboBoxItem Content="YYYY-MM-DD" />
                                <ComboBoxItem Content="DD/MM/YYYY" />
                            </ComboBox>
                        </Grid>
                    </StackPanel>
                </GroupBox>

                <!-- 文件设置 -->
                <GroupBox Header="文件设置">
                    <StackPanel Orientation="Vertical">
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="默认保存路径:"
                                       Style="{StaticResource FieldLabelText}" />
                            <TextBox Grid.Column="1"
                                     MinWidth="220"
                                     Text="{Binding DefaultSavePath}" />
                            <Button Grid.Column="2"
                                    Content="浏览..."
                                    Margin="10,0,0,0"
                                    Command="{Binding BrowseDefaultSavePathCommand}" />
                        </Grid>
                        
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="备份路径:"
                                       Style="{StaticResource FieldLabelText}" />
                            <TextBox Grid.Column="1"
                                     MinWidth="220"
                                     Text="{Binding BackupPath}" />
                            <Button Grid.Column="2"
                                    Content="浏览..."
                                    Margin="10,0,0,0"
                                    Command="{Binding BrowseBackupPathCommand}" />
                        </Grid>
                        
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="日志存储路径:"
                                       Style="{StaticResource FieldLabelText}" />
                            <TextBox Grid.Column="1"
                                     MinWidth="220"
                                     Text="{Binding LogStoragePath}" />
                            <Button Grid.Column="2"
                                    Content="浏览..."
                                    Margin="10,0,0,0"
                                    Command="{Binding BrowseLogStoragePathCommand}" />
                        </Grid>
                        
                        <CheckBox Content="自动创建备份文件夹"
                                  IsChecked="{Binding AutoCreateBackupFolder}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="保存时压缩JSON"
                                  IsChecked="{Binding CompressJsonOnSave}" />
                    </StackPanel>
                </GroupBox>

                <!-- 验证设置 -->
                <GroupBox Header="验证设置">
                    <StackPanel Orientation="Vertical">
                        <CheckBox Content="启用严格验证模式"
                                  IsChecked="{Binding EnableStrictValidation}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="显示警告为错误"
                                  IsChecked="{Binding ShowWarningsAsErrors}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="自动修复常见错误"
                                  IsChecked="{Binding AutoFixCommonErrors}"
                                  Margin="0,0,0,10" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="最大错误显示数量:"
                                       Style="{StaticResource FieldLabelText}" />
                            <TextBox Grid.Column="1"
                                     Width="120"
                                     Text="{Binding MaxErrorDisplayCount}" />
                        </Grid>
                    </StackPanel>
                </GroupBox>

                <!-- 界面设置 -->
                <GroupBox Header="界面设置">
                    <StackPanel Orientation="Vertical">
                        <CheckBox Content="启用深色模式"
                                  IsChecked="{Binding EnableDarkMode}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="显示行号"
                                  IsChecked="{Binding ShowLineNumbers}"
                                  Margin="0,0,0,10" />
                        
                        <CheckBox Content="使用紧凑布局"
                                  IsChecked="{Binding UseCompactLayout}"
                                  Margin="0,0,0,10" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="字体大小:"
                                       Style="{StaticResource FieldLabelText}" />
                            <TextBox Grid.Column="1"
                                     Width="120"
                                     Text="{Binding FontSize}" />
                        </Grid>
                    </StackPanel>
                </GroupBox>

                <!-- 按钮 -->
                <StackPanel Orientation="Horizontal" 
                            HorizontalAlignment="Right">
                    <Button Content="恢复默认设置"
                            Width="120"
                            Height="35"
                            Margin="0,0,8,0"
                            Command="{Binding RestoreDefaultsCommand}" />
                    
                    <Button Content="保存设置"
                            Width="120"
                            Height="35"
                            Margin="0,0,8,0"
                            Style="{StaticResource PrimaryButton}"
                            Command="{Binding SaveSettingsCommand}" />
                    
                    <Button Content="应用"
                            Width="80"
                            Height="35"
                            Command="{Binding ApplySettingsCommand}" />
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
